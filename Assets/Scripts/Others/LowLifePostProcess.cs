using UnityEngine;
using UnityEngine.Rendering.PostProcessing;

public class LowLifePostProcess : MonoBehaviour
{
    private PostProcessVolume _volume;
    private ChromaticAberration _chroma;
    private Vignette _vig;

    private void Start()
    {
        EventManager.Instance.Subscribe("OnLowLife", OnLowLife);
        EventManager.Instance.Subscribe("OnHighLife", OnHighLife);

        _volume = GetComponent<PostProcessVolume>();
        _volume.profile.TryGetSettings(out _chroma);
        _volume.profile.TryGetSettings(out _vig);
    }

    private void OnLowLife(params object[] parameters)
    {
        AudioManager.Instance.Play("TresholdLife");
        _chroma.intensity.value = 1f;
        _vig.intensity.value = .55f;
    }

    private void OnHighLife(params object[] parameters)
    {
        AudioManager.Instance.Stop("TresholdLife");
        _chroma.intensity.value = 0;
        _vig.intensity.value = 0;
    }
}

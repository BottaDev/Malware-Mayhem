using MM.Sound;
using UnityEngine;

namespace MM.Entities.Player.Arms
{
    public class LaserArm : PlayerArm
    {
        #region Private Variables
        [SerializeField] private GameObject laser;
        #endregion
    
        #region Public Functions
        public override void MakeAction()
        {
            if (_currentFireRate <= 0)
                Shoot();
        }
        #endregion
    
        #region Private Functions
        private void Shoot()
        {
            if (muzzleShotParticles != null)
            {
                var forward = transform.forward;
            
                var mz = Instantiate(muzzleShotParticles, shotSpawn.position + forward.normalized, Quaternion.identity);
                mz.transform.forward = forward.normalized;
                mz.transform.parent = shotSpawn;
            }

            Instantiate(laser, shotSpawn.position, shotSpawn.rotation);
        
            SubtractEnergy();
        
            _cameraShaker.ShakeCamera();
        
            AudioManager.Instance.PlayAudioClip(Sounds.SoundType.BasicShot, shotSpawn.position);

            _currentFireRate = fireRate;
        }
        #endregion
    }
}

using MM.Entities.Enemies;
using MM.Bullets;
using UnityEngine;

namespace MM.Common
{
    /// <summary>
    /// Monitors scene transitions and takes actions based on game objects.
    /// It checks for scene transitions between level / sub levels, and destroys or handles objects as needed when a transition occurs.
    /// </summary>
    public class TransitionChecker : MonoBehaviour
    {
        #region Private Variables
        
        private Enemy _enemy;
        private Bullet _bullet;
        
        #endregion
    
        #region MonoBehaviour Functions
        
        private void Awake()
        {
            _enemy = GetComponent<Enemy>();
            _bullet = GetComponent<Bullet>();
        }

        private void Update()
        {
            if (TransitionManager.Instance.IsInSubLevelTransition)
            {
                DestroyObject();
            }
        }
        
        #endregion
    
        #region Private Functions
    
        private void DestroyObject()
        {
            if (_enemy != null)
            {
                _enemy.KillEntity();
            }
            else if (_bullet != null)
            {
                _bullet.ForceReturnToPool();
            }
            else
            {
                Destroy(gameObject);
            }
        }
        
        #endregion
    }
}

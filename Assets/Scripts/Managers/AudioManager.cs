using System;
using System.Linq;
using UnityEngine;
using Random = UnityEngine.Random;

public class AudioManager : MonoBehaviour
{
    public static AudioManager Instance = null;
    
    [SerializeField] private Sounds[] sounds;

    private void Awake()
    {
        if (Instance == null)
            Instance = this;
        else
            Destroy(gameObject);
        
        DontDestroyOnLoad(this);
    }

    public void PlayAudioClip(Sounds.SoundType type, Vector3 position)
    {
        // Get all the sounds of the type
        var soundOfType = sounds.FirstOrDefault(s => s.GetSoundType() == type);
        
        if (soundOfType == null)
        {
            Debug.LogError($"Sound of type '{type}' not found");
            return;   
        }
        
        // Get a random sound from the array
        var soundCLip = soundOfType.GetRandomSound();

        if (soundCLip == null)
        {
            Debug.LogError($"Sound of type '{type}' not found");
            return;   
        }
        
        // TODO: Use pool instead
        AudioSource.PlayClipAtPoint(soundCLip, position);
    }

    public void Play(string name)
    {
        
    }
    
    public void Stop(string name)
    {
        
    }
}
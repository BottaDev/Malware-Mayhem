using MM.Entities.Enemies;
using MM.Events;
using UnityEngine;

namespace MM.Entities.Spawns
{
    public class EnemySpawn : MonoBehaviour
    {
        #region Private Variables
        
        [SerializeField] private Enemy enemyToSpawn;
        
        #endregion

        #region MonoBehaviour Functions
        
        protected virtual void Awake()
        {
            // For testing purposes, should check if the instance exist...
            if (EventManager.Instance != null)
            {
                EventManager.Instance.Trigger(NameEvent.OnEnemySpawn, enemyToSpawn.GetType());
            }
        }
        
        #endregion
        
        #region Public Functions
        
        public Enemy GetEnemyToSpawn()
        {
            return enemyToSpawn;
        }
        
        /// <summary>
        /// Called by the animation event when the enemy is spawned
        /// </summary>
        public virtual void SpawnEnemy()
        {
            if (enemyToSpawn != null)
            {
                Instantiate(enemyToSpawn, transform.position, Quaternion.identity);
            }
            
            Destroy(gameObject);
        }
        
        #endregion
    }
}

using System;
using System.Collections;
using UnityEngine;

public class PauseManager : MonoBehaviourSingleton<PauseManager>
{
    private bool _playerSpawn;
    private PlayerController _playerController;
    [HideInInspector] public bool isPaused;
    [HideInInspector] public bool isPlayerAbsorbing;

    private void Update()
    {
        if(isPlayerAbsorbing) return;
        
        if (Input.GetKeyDown(KeyCode.Escape) && isPaused)
        {
            ResumeLevel();
        }
        else if (Input.GetKeyDown(KeyCode.Escape) && !isPaused)
        {
            PauseLevel();
        }
    }

    public void SetLevelSpeed(float scale)
    {
        Time.timeScale = scale;
        Time.fixedDeltaTime = Time.fixedUnscaledDeltaTime * scale;
    }
    
    public void PauseLevel()
    {
        isPaused = true;
        
        AudioManager.Instance.StopMusic();
        
        SetLevelSpeed(0);
        UIManager.Instance.PauseLevel();
    }

    public void ResumeLevel()
    {
        isPaused = false;
        AudioManager.Instance.PlayMusic("Level 1-1");
        SetLevelSpeed(1);
        UIManager.Instance.ResumeLevel();
    }
}
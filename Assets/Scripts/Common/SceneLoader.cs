using UnityEngine;
using UnityEngine.SceneManagement;
using MM.Data;

namespace MM.Common
{
    /// <summary>
    /// Manages scene transitions and game-level control.
    /// It provides functions for reloading the current level, changing to a specific level,
    /// exiting the game, returning to the main menu, and setting the next level to load. 
    /// </summary>
    public class SceneLoader : MonoBehaviour
    {
        #region Public Variables
        public static SceneLoader Instance = null;
        #endregion

        #region MonoBehaviour Functions
        private void Awake()
        {
            if (Instance == null)
                Instance = this;
        }
        #endregion
    
        #region Public Functions
        public static void RetryCurrentLevel()
        {
            ChangeLevel(DataManager.CurrentLevel);
        }

        public static void ChangeLevel(string level)
        {
            SceneManager.LoadScene(level);
        }

        public void ExitGame()
        {
            Application.Quit();
        }

        public void MainMenu()
        {
            SceneManager.LoadScene(0);
        }

        /// <summary>
        /// Sets the next level to load, if available.
        /// </summary>
        public void SetNextLevel()
        {
            var level = GetNextLevel();
        
            if (string.IsNullOrEmpty(level))
                return;
        
            ChangeLevel(level);
        }
        #endregion
    
        #region Private Functions
        private static string GetNextLevel()
        {
            var nextLevel = DataManager.CurrentLevel switch
            {
                "Tutorial" => "Level 1",
                _ => string.Empty
            };

            return nextLevel;
        }
        #endregion
    }
}

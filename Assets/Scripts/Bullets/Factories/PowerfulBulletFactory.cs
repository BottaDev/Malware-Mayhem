using MM.Resource;
using UnityEngine;

namespace MM.Bullets.Factories
{
    public class PowerfulBulletFactory
    {
        #region Private Variables

        private readonly Transform _parent;
        private readonly BulletColor _color;

        #endregion

        #region Constructor

        public PowerfulBulletFactory(Transform parent, BulletColor color)
        {
            _parent = parent;
            _color = color;
        }

        #endregion

        #region Public Functions
        
        public Bullet Create()
        {
            Bullet bullet;

            switch (_color)
            {
                default:
                case BulletColor.Green:
                    bullet = ResourceManager.Instance.ResourceTable.GetValue("PowerfulGreenBullet").GetComponent<Bullet>();
                    break;
                case BulletColor.Blue:
                    bullet = ResourceManager.Instance.ResourceTable.GetValue("PowerfulBlueBullet").GetComponent<Bullet>();
                    break;
                case BulletColor.Red:
                    bullet = ResourceManager.Instance.ResourceTable.GetValue("PowerfulRedBullet").GetComponent<Bullet>();
                    break;
                case BulletColor.Orange:
                    bullet = ResourceManager.Instance.ResourceTable.GetValue("PowerfulOrangeBullet").GetComponent<Bullet>();
                    break;
            }

            return Object.Instantiate(bullet, _parent);
        }

        #endregion
    }
}
using MM.Common;
using MM.Others;
using UnityEngine;

namespace MM.UI
{
    /// <summary>
    /// Manage the menu with the world map.
    /// </summary>
    public class MainMenuManager : MonoBehaviourSingleton<MainMenuManager>
    {
        #region Private Variables

        [SerializeField] private GameObject worldMap;

        private Vector3 _worldMapStartPosition;
        private MainMenuPlanetController _planetController;
        private bool _canSelectLevels;

        #endregion

        #region MonoBehaviour Functions

        protected override void Awake()
        {
            base.Awake();

            _worldMapStartPosition = worldMap.transform.position;
        }

        private void Start()
        {
            _planetController = worldMap.GetComponent<MainMenuPlanetController>();
        }

        #endregion

        #region Public Functions

        public void SetPlayView()
        {
            var cam = Camera.main;

            if (cam != null)
            {
                var wM = worldMap.transform.position;
                worldMap.transform.position = new Vector3(cam.transform.position.x, wM.y, wM.z);
            }

            worldMap.GetComponent<ObjectRotator>().enabled = false;
            _planetController.SetCanRotate(true);

            _canSelectLevels = true;
        }

        public void SetMenuView()
        {
            worldMap.transform.position = _worldMapStartPosition;

            worldMap.GetComponent<ObjectRotator>().enabled = true;
            _planetController.SetCanRotate(false);

            _canSelectLevels = false;
        }

        public bool CanSelectLevels()
        {
            return _canSelectLevels;
        }

        #endregion
    }
}
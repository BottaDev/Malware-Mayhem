using MM.Events;
using MM.Sound;
using MM.Gameplay;
using UnityEngine;

public class SubBoss : Boss
{
    [Header("SubBoss Parameters")] 
    [SerializeField] protected int submoduleIndex;

    public int GetSubmoduleIndex() => submoduleIndex;
    
    protected override void Start() { /* Do nothing... */ }

    public override void TakeDamage(float damage, PlayerArm.ArmType aType = PlayerArm.ArmType.None, bool showDamage = true)
    {
        _currentHp -= damage;
        
        if (showDamage)
            StartCoroutine(ShowDamage());
        
        AudioManager.Instance.PlayAudioClip(Sounds.SoundType.EnemyDamaged, transform.position);
        
        if (_currentHp <= 0)
        {
            var player = LevelManager.Instance.GetPlayer();
            Destroy(player.gameObject);
            
            EventManager.Instance.Trigger(NameEvent.OnReturnedBoss, true, submoduleIndex);
        }
    }
}

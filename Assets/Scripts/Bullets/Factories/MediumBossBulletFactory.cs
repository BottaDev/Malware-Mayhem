using UnityEngine;
using Object = UnityEngine.Object;
using MM.Resource;

namespace MM.Bullets.Factories
{
    public class MediumBossBulletFactory : IFactory<Bullet>
    {
        #region Private Variables
        private readonly Transform _parent;
        private readonly BulletColor _color;
        #endregion
    
        #region Public Functons
        public MediumBossBulletFactory(Transform parent, BulletColor color)
        {
            _parent = parent;
            _color = color;
        }
    
        public Bullet Create()
        {
            Bullet bullet;

            switch (_color)
            {
                default:
                case BulletColor.Green:
                    bullet = ResourceManager.Instance.ResourceTable.GetValue("MediumGreenBossBullet").GetComponent<Bullet>();
                    break;
                case BulletColor.Blue:
                    bullet = ResourceManager.Instance.ResourceTable.GetValue("MediumBlueBossBullet").GetComponent<Bullet>();
                    break;
                case BulletColor.Red:
                    bullet = ResourceManager.Instance.ResourceTable.GetValue("MediumRedBossBullet").GetComponent<Bullet>();
                    break;
                case BulletColor.Orange:
                    bullet = ResourceManager.Instance.ResourceTable.GetValue("MediumOrangeBossBullet").GetComponent<Bullet>();
                    break;
            }

            return Object.Instantiate(bullet, _parent);
        }
        #endregion
    }
}

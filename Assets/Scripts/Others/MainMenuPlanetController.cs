using UnityEngine;

public class MainMenuPlanetController : MonoBehaviour 
{
    [SerializeField] private float sensitivity = 0.4f;
    
    private Vector3 _mouseReference;
    private Vector3 _mouseOffset;
    private Vector3 _rotation;
    private bool _isRotating;
     
    private void Start ()
    {
        _rotation = Vector3.zero;
    }
     
    private void Update()
    {
        Rotate();
    }

    /// <summary>
    /// Rotate the planet using the mouse when clicking and dragging
    /// </summary>
    private void Rotate()
    {
        if (!_isRotating) 
            return;
        
        _mouseOffset = (Input.mousePosition - _mouseReference);
        
        _rotation.y = -(_mouseOffset.x) * sensitivity;
        _rotation.x = -(_mouseOffset.y) * sensitivity;
        
        transform.eulerAngles += _rotation;
        
        _mouseReference = Input.mousePosition;
    }

    private void SetRotating(bool isRotating)
    {
        _isRotating = isRotating;
        
        if (isRotating)
            _mouseReference = Input.mousePosition;
    }
    
    private void OnMouseDown()
    {
        SetRotating(true);
        
        // Remove the level window if player rotates the planet
        MenuUIManager.Instance.ShowLevel(0);
    }
     
    private void OnMouseUp()
    {
        SetRotating(false);
    }
}